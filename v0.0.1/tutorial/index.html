<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · FinancialMarketSimulation.jl</title><meta name="title" content="Tutorial · FinancialMarketSimulation.jl"/><meta property="og:title" content="Tutorial · FinancialMarketSimulation.jl"/><meta property="twitter:title" content="Tutorial · FinancialMarketSimulation.jl"/><meta name="description" content="Documentation for FinancialMarketSimulation.jl."/><meta property="og:description" content="Documentation for FinancialMarketSimulation.jl."/><meta property="twitter:description" content="Documentation for FinancialMarketSimulation.jl."/><meta property="og:url" content="https://sliemelela.github.io/FinancialMarketSimulation.jl/tutorial/"/><meta property="twitter:url" content="https://sliemelela.github.io/FinancialMarketSimulation.jl/tutorial/"/><link rel="canonical" href="https://sliemelela.github.io/FinancialMarketSimulation.jl/tutorial/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FinancialMarketSimulation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Level-1:-The-Basics-(Interest-Rates)"><span>Level 1: The Basics (Interest Rates)</span></a></li><li><a class="tocitem" href="#Level-2:-Adding-a-Correlated-Stock"><span>Level 2: Adding a Correlated Stock</span></a></li><li><a class="tocitem" href="#Level-3:-Bonds-and-Market-Price-of-Risk"><span>Level 3: Bonds &amp; Market Price of Risk</span></a></li><li><a class="tocitem" href="#Level-4:-Simple-and-Excess-Returns"><span>Level 4: Simple and Excess Returns</span></a></li><li><a class="tocitem" href="#Level-5:-Analysis-and-Plotting"><span>Level 5: Analysis &amp; Plotting</span></a></li></ul></li><li><a class="tocitem" href="../models/">Models &amp; Math</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sliemelela/FinancialMarketSimulation.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial:-Building-a-Financial-Market"><a class="docs-heading-anchor" href="#Tutorial:-Building-a-Financial-Market">Tutorial: Building a Financial Market</a><a id="Tutorial:-Building-a-Financial-Market-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial:-Building-a-Financial-Market" title="Permalink"></a></h1><p>This guide will walk you through building a simulation, starting from a single asset and ending with a full economy including inflation, bonds, and derivatives.</p><p>The general idea of the package is to follow the following steps:</p><ol><li>Specify a process that you would like to simulate using either some SDE or some built in process  that is given by this package.</li><li>Specify the configuration that are needed to run the simulation, e.g. the amount of paths, the  amount of timesteps etc.</li><li>Run the builder command.</li><li>Plot using built in plotter.</li></ol><p>Any analysis that one wants to do with the generated paths can be done by simply extracting the paths from the object in which everything is stored. Let us make this concrete by building up a more sophisticated model step by step.</p><h2 id="Level-1:-The-Basics-(Interest-Rates)"><a class="docs-heading-anchor" href="#Level-1:-The-Basics-(Interest-Rates)">Level 1: The Basics (Interest Rates)</a><a id="Level-1:-The-Basics-(Interest-Rates)-1"></a><a class="docs-heading-anchor-permalink" href="#Level-1:-The-Basics-(Interest-Rates)" title="Permalink"></a></h2><p>The package gives the user the option to model some stochastic process by specifying some generic Stochastic Differential Equations (SDE&#39;s). On top of this, the package also has some built in stochastic processes, like the Vasicek process. To get an overview of all built in stochastic processes, visit the <a href="../models/">Models &amp; Math</a> section. We will first how how to built the latter in the code example below.</p><p>To create a Vasicek process, we will use the <code>VasicekProcess</code> struct. This struct accepts the parameters <span>$\kappa$</span>, <span>$\theta$</span> and <span>$\sigma$</span> such that the process follows the SDE</p><p class="math-container">\[    dr_t = \kappa(\theta - r_t) dt + \sigma_r dW_t^1,\]</p><p>where <span>$dW_t^1$</span> is some Brownian motion. Below is an actual written out example.</p><pre><code class="language-julia hljs">using FinancialMarketSimulation

# dr_t = κ(θ - r_t)dt + σ dW_t
# κ=0.3, θ=0.05, σ_r =0.02, r0=0.05
r_model = VasicekProcess(:r, 0.3, 0.05, 0.02, 0.05, 1)

# We can specify Time (T) and Amount of Intervals (M), and dt is calculated automatically.
config = MarketConfig(
    sims = 500,
    T    = 1.0,
    M    = 100,
    processes = [r_model]
)

world = build_world(config)
plot_simulation(world)</code></pre><p>Note that the last parameter <code>1</code> in the <code>VasicekProcess</code> struct specifies &#39;which shock&#39; to use, i.e. by writing down <code>1</code>, we create a Brownian shock that we index by the number <code>1</code> that is used to generate the process.</p><p>To access the paths, use</p><pre><code class="language-julia hljs">r_path = world.paths.r</code></pre><p>where <code>r</code> comes from the name <code>:r</code> that you supplied the <code>VasicekProcess</code> struct with when it was initialized.</p><h2 id="Level-2:-Adding-a-Correlated-Stock"><a class="docs-heading-anchor" href="#Level-2:-Adding-a-Correlated-Stock">Level 2: Adding a Correlated Stock</a><a id="Level-2:-Adding-a-Correlated-Stock-1"></a><a class="docs-heading-anchor-permalink" href="#Level-2:-Adding-a-Correlated-Stock" title="Permalink"></a></h2><p>Now let&#39;s add a stock process. We want the stock market to be negatively correlated with interest rate shocks (e.g., rates up, stocks down). We will be creating the stock process using the SDE</p><p class="math-container">\[    dS_t = \mu S_t dt + \sigma S_t dW_t^2,\]</p><p>To create the stochastic process using this SDE, we use the <code>GenericSDEProcess</code> struct. As opposed to before, we cannot directly supply this struct with the parameters <span>$\mu$</span> and <span>$\sigma$</span> since it has to be able to create <em>any</em> (Markovian) SDE. To circumvent this, we supply the struct with two functions that specify the drift and diffusion terms in the SDE, which correspond to</p><p class="math-container">\[    (t, S) \mapsto \mu S \\
    (t, S) \mapsto \sigma S,\]</p><p>respectively. Additionally, note that we are now using some other Brownian motion <span>$dW_t^2$</span> that must be correlated with <span>$dW_t^1$</span>, i.e. we want to specify <span>$\text{Cor}[dW_t^1, dW_t^2] = \rho \in \mathbb{R}$</span>. Let us see how this works in practice.</p><pre><code class="language-julia hljs"># Define Stock Process
# dS = μ * S dt + σ * S dW_2 with μ = 0.05 and σ = 0.2 and initial value of 100.
stock = GenericSDEProcess(:S, (t,x)-&gt;0.05*x, (t,x)-&gt;0.2*x, 100.0, [2])

# Define Correlation Matrix
# Correlation between Shock 1 (Rate) and Shock 2 (Stock) is -0.4
ρ = [ 1.0 -0.4;
     -0.4  1.0]

config = MarketConfig(
    sims=500, T=1.0, M=100,
    processes=[r_model, stock],
    correlations=ρ
)

world = build_world(config)</code></pre><p>Now note that we have supplied the <code>GenericSDEProcess</code> with a <code>[2]</code> as the final argument. Using <code>2</code> creates another Brownian shock that is correlated with <code>1</code> using the specified correlation matrix <span>$\rho$</span>. The reason for supplying it as a vector <code>[2]</code>, however, is that in the generic case we might want to use more than one shock. So suppose we would like to create a stochastic process using the SDE</p><p class="math-container">\[    dS_t = \mu S_t dt + \sigma_2 S_t dW_t^2 + \sigma_3 S_t dW_t^3,\]</p><p>then we can rewrite this to</p><p class="math-container">\[    dS_t = \mu S_t dt
        + \begin{pmatrix} \sigma_2 S_t &amp; \sigma_3 S_t \end{pmatrix}
          \begin{pmatrix} dW_t^2 \\ dW_t^3 \end{pmatrix}\]</p><p>So in this (more complicated) case, the drift function would remain the same while the diffusion function would be</p><p class="math-container">\[    (t, S) \mapsto \begin{pmatrix} \sigma_2 S &amp; \sigma_3 S \end{pmatrix},\]</p><p>The code would be then (for example) be</p><pre><code class="language-julia hljs"># Define Stock Process
stock = GenericSDEProcess(:S, (t,x)-&gt;0.05*x, (t,x)-&gt;(0.2*x, 0.3*x), 100.0, [2, 3])

# Define Correlation Matrix
ρ = [ 1.0 -0.4 -0.2;
     -0.4  1.0 0.5;
     -0.2  0.5 1.0]

config = MarketConfig(
    sims=500, T=1.0, M=100,
    processes=[r_model, stock],
    correlations=ρ
)

world = build_world(config)</code></pre><h2 id="Level-3:-Bonds-and-Market-Price-of-Risk"><a class="docs-heading-anchor" href="#Level-3:-Bonds-and-Market-Price-of-Risk">Level 3: Bonds &amp; Market Price of Risk</a><a id="Level-3:-Bonds-and-Market-Price-of-Risk-1"></a><a class="docs-heading-anchor-permalink" href="#Level-3:-Bonds-and-Market-Price-of-Risk" title="Permalink"></a></h2><p>It can also be of interest to model both nominal and inflation linked bonds. In both cases we must specify the so called factor loadings <span>$\phi$</span> that are linked to the market price of risk <span>$\lambda$</span> via the formula <span>$\lambda = \rho \phi$</span>.</p><h3 id="Nominal-Bonds"><a class="docs-heading-anchor" href="#Nominal-Bonds">Nominal Bonds</a><a id="Nominal-Bonds-1"></a><a class="docs-heading-anchor-permalink" href="#Nominal-Bonds" title="Permalink"></a></h3><p>To create nominal bonds, we must supply it with the underlying interest rate <span>$r_t$</span> and the factor loadings <span>$\phi_r, \phi_S$</span> corresponding to the interest rate <span>$r_t$</span> and stock process <span>$S$</span> respectively. From here, the implementation is quite simple:</p><pre><code class="language-julia hljs"># Risk Factors: [ϕ_rate, ϕ_stock]
# We assume a negative risk premium for both.
market_risk = [-0.1, -0.2]

# Nominal Bond P_N depends on :r
bond = NominalBondProcess(:P_N, r_model, market_risk)

config = MarketConfig(sims=500, T=1.0, M=100, processes=[r_model, stock, bond], correlations=ρ)
world = build_world(config)</code></pre><p>Note that we do not need to specify a &quot;new&quot; shock as the bond process is completely determined by <span>$r_t$</span> and the market prices of risk.</p><h3 id="Inflation-Linked-Bonds"><a class="docs-heading-anchor" href="#Inflation-Linked-Bonds">Inflation Linked Bonds</a><a id="Inflation-Linked-Bonds-1"></a><a class="docs-heading-anchor-permalink" href="#Inflation-Linked-Bonds" title="Permalink"></a></h3><p>Similarly, to create inflation linked bonds we must also create an inflation process and a CPI (Consumer Price Index) process. The inflation process <span>$\pi_t$</span> is simple to instantiate:</p><pre><code class="language-julia hljs">pi_model = VasicekProcess(:pi, 0.1, 0.02, 0.01, 0.02, 3)</code></pre><p>The CPI process however, can be a bit more cumbersome. Let us treat the case of the CPI process <span>$\Pi_t$</span> being</p><p class="math-container">\[d\Pi_t = \Pi_t \pi_t dt.\]</p><p>A fair question that will most likely come up is: how do we give the generic SDE struct access to other stochastic processes? The answer is simple, we use functions that use more arguments! The drift process is now simply</p><p class="math-container">\[(t, \Pi, \pi) \mapsto \Pi \pi.\]</p><p>To make sure <span>$\pi$</span> in the formula corresponds to the path <span>$\pi_t$</span> we actually created before, we provide an extra argument to the <code>GenericSDEProcess</code> as follows:</p><pre><code class="language-julia hljs">cpi_drift(t, Pi, pi_val) = Pi * pi_val
cpi_diff(t, Pi, pi_val)  = 0.0

cpi_model = GenericSDEProcess(
    :CPI, cpi_drift, cpi_diff, 100.0,
    Int[],   # No Shocks
    [:pi]    # Dependency: Reads the :pi path
)</code></pre><p>We can finally create the inflation linked bond using</p><pre><code class="language-julia hljs">mprs = [-0.1, -0.2, -0.1]
infl_bond = InflationBondProcess(:P_I, r_model, pi_model, :CPI, mprs)
config = MarketConfig(
    sims=100, T=1.0, dt=0.01, M=100,
    processes=[r_model, stock, bond, pi_model, cpi_model, infl_bond]
)</code></pre><p>Note that we have to specify another factor loading corresponding to the shock of the inflation process. Also note that the order of <code>processes</code> in <code>MarketConfig</code> matters. For example, since <code>cpi_model</code> is depends on both <code>r_model</code> and <code>pi_model</code>, it must be supplied later in the <code>processes</code> vector. Something similar holds for <code>infl_bond</code> and <code>bond</code>.</p><h2 id="Level-4:-Simple-and-Excess-Returns"><a class="docs-heading-anchor" href="#Level-4:-Simple-and-Excess-Returns">Level 4: Simple and Excess Returns</a><a id="Level-4:-Simple-and-Excess-Returns-1"></a><a class="docs-heading-anchor-permalink" href="#Level-4:-Simple-and-Excess-Returns" title="Permalink"></a></h2><p>Given an already existing process, we can easily create the simple, gross and excess return process by</p><pre><code class="language-julia hljs"># Simple Return of Stock
ret_S = SimpleReturnProcess(:R_S, :S)

# Excess Return of Stock over Rate
ex_ret_S = ExcessReturnProcess(:Re_S, :S, :r)

# Gross return of Stock
gross_S = GrossReturnProcess(:G_S, :S)</code></pre><h2 id="Level-5:-Analysis-and-Plotting"><a class="docs-heading-anchor" href="#Level-5:-Analysis-and-Plotting">Level 5: Analysis &amp; Plotting</a><a id="Level-5:-Analysis-and-Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Level-5:-Analysis-and-Plotting" title="Permalink"></a></h2><p>We can zoom in on specific events or check distributions at specific times.</p><pre><code class="language-julia hljs"># Plot only the distribution at the halfway point (t=0.5)
plot_simulation(world,
    plot_traj=false,
    plot_dist=true,
    dist_time=0.5
)

# Plot the trajectories of everything between t=0.5 and t=1.0
plot_simulation(world,
    plot_traj=true,
    plot_dist=false,
    time_range=(0.5, 1.0)
)

# Plot full trajectories and distributions at the final time and  just rates and the nominal bond.
plot_simulation(world, vars=[:r, :P_N])</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../models/">Models &amp; Math »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 18 February 2026 03:37">Wednesday 18 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
